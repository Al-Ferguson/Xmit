package com.bytezone.xmit;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

// -----------------------------------------------------------------------------------//
public abstract class Reader implements Iterable<Dataset>
// -----------------------------------------------------------------------------------//
{
  final String fileName;
  private final int level;
  boolean incomplete;
  final List<Dataset> datasets = new ArrayList<> ();
  Dataset activeDataset;

  // ---------------------------------------------------------------------------------//
  public Reader (String fileName, int level)
  // ---------------------------------------------------------------------------------//
  {
    this.fileName = fileName;
    this.level = level;
  }

  // ---------------------------------------------------------------------------------//
  public boolean isIncomplete ()
  // ---------------------------------------------------------------------------------//
  {
    return incomplete;
  }

  // ---------------------------------------------------------------------------------//
  public String getFileName ()
  // ---------------------------------------------------------------------------------//
  {
    return fileName;
  }

  // ---------------------------------------------------------------------------------//
  public abstract String getDatasetName ();
  // ---------------------------------------------------------------------------------//

  // ---------------------------------------------------------------------------------//
  public int getLevel ()
  // ---------------------------------------------------------------------------------//
  {
    return level;
  }

  // ---------------------------------------------------------------------------------//
  public int size ()
  // ---------------------------------------------------------------------------------//
  {
    return datasets.size ();
  }

  // ---------------------------------------------------------------------------------//
  public Dataset getDataset (int index)
  // ---------------------------------------------------------------------------------//
  {
    return datasets.get (index);
  }

  // ---------------------------------------------------------------------------------//
  public Dataset getActiveDataset ()
  // ---------------------------------------------------------------------------------//
  {
    return activeDataset;
  }

  // ---------------------------------------------------------------------------------//
  @Override
  public Iterator<Dataset> iterator ()
  // ---------------------------------------------------------------------------------//
  {
    return datasets.iterator ();
  }

  // ---------------------------------------------------------------------------------//
  static byte[] readFile (File file)
  // ---------------------------------------------------------------------------------//
  {
    try
    {
      return Files.readAllBytes (file.toPath ());
    }
    catch (IOException e)
    {
      e.printStackTrace ();
      return null;
    }
  }

  // ---------------------------------------------------------------------------------//
  @Override
  public String toString ()
  // ---------------------------------------------------------------------------------//
  {
    return String.format ("Reader: %s", fileName);
  }
}
